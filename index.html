<!DOCTYPE html>
<html>
<head>
    <title>Mijn Verlanglijst</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary-color: #6200ea;
            --hover-color: #3700b3;
            --background-color: #f4f4f9;
            --card-background: white;
            --text-color: #333;
            --success-color: #4CAF50;
            --error-color: #f44336;
            --gray-100: #f7f7f7;
            --gray-200: #e6e6e6;
            --gray-300: #d4d4d4;
            --transition-speed: 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--hover-color));
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 600;
            letter-spacing: -0.5px;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            animation: fadeIn var(--transition-speed) ease-out;
        }

        .wishlist-item {
            background: var(--card-background);
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: all var(--transition-speed) ease;
            animation: fadeIn var(--transition-speed) ease-out;
        }

        .wishlist-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 12px rgba(0,0,0,0.15);
        }

        .item-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-bottom: 1px solid var(--gray-200);
            transition: transform var(--transition-speed) ease;
        }

        .wishlist-item:hover .item-image {
            transform: scale(1.05);
        }

        .item-content {
            padding: 1.5rem;
        }

        .item-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 0 0 1rem 0;
            color: var(--text-color);
        }

        .item-link {
            display: inline-flex;
            align-items: center;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 1rem;
            transition: color var(--transition-speed) ease;
        }

        .item-link:hover {
            color: var(--hover-color);
        }

        .item-link::after {
            content: 'â†—';
            margin-left: 4px;
            font-size: 1.1em;
        }

        .item-status {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 1rem;
        }

        .bought {
            opacity: 0.7;
            transform: scale(0.98);
        }

        .bought .item-title {
            text-decoration: line-through;
            color: #999;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            width: 100%;
            transition: all var(--transition-speed) ease;
            position: relative;
            overflow: hidden;
        }

        button:hover {
            background-color: var(--hover-color);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background-color: var(--gray-300);
            cursor: not-allowed;
            transform: none;
        }

        .status-message {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 8px;
            color: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 1000;
            animation: fadeIn var(--transition-speed) ease-out;
        }

        .success { 
            background-color: var(--success-color);
            animation: pulse 1s ease-out;
        }

        .error { 
            background-color: var(--error-color);
            animation: pulse 1s ease-out;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            backdrop-filter: blur(4px);
            animation: fadeIn var(--transition-speed) ease-out;
        }

        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            max-width: 90%;
            width: 500px;
            animation: fadeIn var(--transition-speed) ease-out;
        }

        .modal h2 {
            margin: 0 0 1rem;
            color: var(--primary-color);
            font-size: 1.5rem;
        }

        .modal-content {
            margin: 1rem 0;
            line-height: 1.6;
        }

        .modal ol {
            padding-left: 1.5rem;
        }

        .modal li {
            margin: 0.5rem 0;
        }

        .modal button {
            margin-top: 1.5rem;
        }

        .loading {
            position: relative;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255,255,255,0.2),
                transparent
            );
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            from { transform: translateX(-100%); }
            to { transform: translateX(100%); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
                grid-template-columns: 1fr;
            }

            header h1 {
                font-size: 2rem;
            }

            .modal {
                width: 85%;
                padding: 1.5rem;
            }
        }

        .intro-text {
            max-width: 800px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
            animation: fadeIn var(--transition-speed) ease-out;
        }

        .name-input {
            width: 100%;
            padding: 0.75rem;
            margin: 1rem 0;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color var(--transition-speed) ease;
        }

        .name-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .undo-button {
            background-color: var(--error-color);
            margin-top: 0.5rem;
        }

        .undo-button:hover {
            background-color: #d32f2f;
        }

        .modal-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .contact-info {
            background: var(--gray-100);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .claimed-by {
            font-style: italic;
            color: var(--success-color);
        }

        .button-group {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .button-group button {
            margin: 0;
        }

        .unclaim-button {
            background-color: var(--error-color);
        }

        .unclaim-button:hover {
            background-color: #d32f2f;
        }

        #contactEmail {
            font-weight: bold;
            color: var(--primary-color);
        }
    </style>
</head>
<body>
    <header>
        <h1>Verlanglijst</h1>
    </header>
    
    <div class="intro-text">
        <h2>Welkom!</h2>
        <p>Jij bent op deze pagina omdat je hebt gevraagd wat voor cadeau wensen Bram heeft. 
           Hieronder vind je een overzicht van alle wensen. Als je iets wilt kopen, klik dan op de knop "Reserveer cadeau" 
           bij het betreffende item.</p>
        <p>Laat je naam achter zodat anderen kunnen zien wat al gereserveerd is.</p>
        <p id="contactInfo" class="contact-info">
            Als je een cadeau hebt gereserveerd, laat dit dan even weten aan Bram om te bevestigen dat je het cadeau gaat kopen.
        </p>
    </div>

    <div id="status-container"></div>
    <div class="container" id="wishlist"></div>
    
    <div class="modal-overlay" id="modalOverlay"></div>
    <div class="modal" id="claimModal">
        <h2>Cadeau Reserveren</h2>
        <div class="modal-content">
            <p>Vul je naam in om dit cadeau te reserveren:</p>
            <form class="modal-form" onsubmit="handleClaimSubmit(event)">
                <div>
                    <label for="claimerName">Je naam:</label>
                    <input type="text" id="claimerName" class="name-input" required placeholder="Jouw naam" />
                </div>
                <div class="button-group">
                    <button type="button" class="undo-button" onclick="closeClaimModal()">Annuleren</button>
                    <button type="submit">Bevestig Reservering</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'wishlistClaims';
        let claims = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');

        function getLocalData(data) {
            return data.map(item => ({
                ...item,
                claim: claims[item.name] || null
            }));
        }

        async function fetchWishlist() {
            try {
                const response = await fetch('wishlist.json');
                if (!response.ok) throw new Error('Network response was not ok');
                
                const data = await response.json();
                const localizedData = getLocalData(data);
                const list = document.getElementById('wishlist');
                
                if (JSON.stringify(localizedData) !== list.dataset.lastData) {
                    list.innerHTML = localizedData.map(item => `
                        <div class="wishlist-item ${item.claim ? 'bought' : ''}">
                            <img src="${item.image}" alt="${item.name}" class="item-image" onerror="this.src='images/placeholder.svg'">
                            <div class="item-content">
                                <h2 class="item-title">${item.name}</h2>
                                ${item.url ? `<a href="${item.url}" target="_blank" class="item-link">Bekijk product</a>` : ''}
                                <div class="item-status">
                                    ${item.claim 
                                        ? `<span class="claimed-by">Gereserveerd door: ${item.claim.name}</span>
                                           ${item.claim.name === localStorage.getItem('myName') 
                                               ? `<button class="unclaim-button" onclick="unclaimGift('${item.name}')">Reservering Annuleren</button>` 
                                               : ''}`
                                        : `<button onclick="showClaimModal('${item.name}')">Reserveer Cadeau</button>`}
                                </div>
                            </div>
                        </div>
                    `).join('');
                    list.dataset.lastData = JSON.stringify(localizedData);
                }
            } catch (error) {
                console.error('Error fetching wishlist:', error);
                showStatus('Er is een fout opgetreden bij het laden van de lijst.', 'error');
            }
        }

        function showClaimModal(itemName) {
            const modal = document.getElementById('claimModal');
            const overlay = document.getElementById('modalOverlay');
            modal.dataset.itemName = itemName;
            
            // Pre-fill with previous value if available
            const myName = localStorage.getItem('myName');
            if (myName) document.getElementById('claimerName').value = myName;
            
            modal.style.display = 'block';
            overlay.style.display = 'block';
        }

        function closeClaimModal() {
            const modal = document.getElementById('claimModal');
            const overlay = document.getElementById('modalOverlay');
            modal.style.display = 'none';
            overlay.style.display = 'none';
        }

        function handleClaimSubmit(event) {
            event.preventDefault();
            const modal = document.getElementById('claimModal');
            const itemName = modal.dataset.itemName;
            const name = document.getElementById('claimerName').value;

            // Store claim
            claims[itemName] = { name, timestamp: Date.now() };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(claims));
            
            // Store user name for pre-filling next time
            localStorage.setItem('myName', name);

            closeClaimModal();
            showStatus(`Je hebt "${itemName}" gereserveerd! Laat even aan Bram weten dat je dit cadeau gaat kopen.`, 'success');
            fetchWishlist();
        }

        function unclaimGift(itemName) {
            delete claims[itemName];
            localStorage.setItem(STORAGE_KEY, JSON.stringify(claims));
            showStatus('Je reservering is geannuleerd.', 'success');
            fetchWishlist();
        }

        function showStatus(message, type) {
            const container = document.getElementById('status-container');
            const statusDiv = document.createElement('div');
            statusDiv.className = `status-message ${type}`;
            statusDiv.textContent = message;
            container.innerHTML = '';
            container.appendChild(statusDiv);
            setTimeout(() => statusDiv.remove(), 5000);
        }

        // Initial load
        fetchWishlist();
    </script>
</body>
</html>
